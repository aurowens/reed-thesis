
############################################################################################
#####################################INFFORESTS VIZ#########################################
############################################################################################
############################################################################################


d <- d2[1:100,]
xs <- d2[1:400, 1:12]
y <- d2$y[1:400]
mtry = 6

t1 <- tree.rf(d2$y[1:400],d2[1:400, 1:4],mtry = 4)

r <- rforest(d2$y[1:400],d2[1:400, 1:4],mtry = 2, ntree = 100)

r_without_cor <- rforest(y, d2[1:400, 4:12] , mtry = 3, ntree = 100)

virf <- infforest(r,d2$y[1:400],d2[1:400, 1:4])
virfStrobl <- conditional.inf(r,d2$y[1:400],d2[1:400, 1:4])
virf_permuted <- permuted.inf(r,d2$y[1:400],d2[1:400, 1:4])

library(ggplot2)

ggplot(aes(x = V4), data = as.data.frame(virfStrobl)) + geom_density()
